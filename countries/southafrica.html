<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>South Africa ¬∑ Around the World in 80 Games</title>
  <link rel="stylesheet" href="../assets/css/style.css" />
</head>

<body>

  <header>
    <h1>South Africa</h1>
    <div class="country-nav">
    <a href="botswana.html" class="prev">‚Üê Botswana</a>
    <a href="uganda.html" class="next">Uganda ‚Üí</a>
    </div>
  </header>

  <main>
    <section>
      <h2>Overview</h2>
      <div class="placeholder">
      <p>Our next stop takes us to South Africa, where the Atlantic Ocean meets the Indian Ocean at the Cape of Good Hope, where mountains rise above wild plains and modern vineyards, and where a mosaic of cities reflect a truly diverse, and often troubled, cultural history.</p>
      <p>However, it‚Äôs motorsport that takes us to the southernmost tip of this vast continent, and the famous Kyalami circuit - home to the South African Formula One Grand Prix 20 times across the 1960, 70, 80s and 90s, and where legends like Clark, Stewart, and Senna once chased glory beneath the African sun.</p>
      <p>Like all motorsports, Rallyman GT sees players balance speed, strategy and a healthy dose of ‚Äòpush your luck‚Äô as they jostle around the track, rolling dice to manage their cars, block the racing line, and make it first to the finish!</p>
      
      </div>
    </section>

    <section>
      <h2>RallymanGT results</h2>
      <div class="placeholder">
     <div id="rallymangt-tournaments"></div>
</div>
    </section>

  </main>

  <footer>
    <p>¬© 2025 Around the World in 80 Games</p>
  </footer>

  <!-- ‚úÖ Load global script FIRST so BASE + sidenav are ready -->
  <script src="../assets/js/script.js"></script>

  <!-- ‚úÖ Country-specific logic AFTER script.js -->
  <script>
  const COUNTRY_NAME = "South Africa"; // ‚úÖ change per country

  const TROPHIES = {
    "1st": "ü•á",
    "2nd": "ü•à",
    "3rd": "ü•â"
  };

  async function loadCountryTournaments() {
    // ‚úÖ Load tournament data + metadata
    const tournaments = await fetch(`${BASE}/data/tournaments.json`).then(r => r.json());
    const meta = await fetch(`${BASE}/data/tournament-meta.json`).then(r => r.json());

    // ‚úÖ Filter metadata to only this country‚Äôs tournaments
    const countryTournaments = Object.entries(meta)
      .filter(([id, info]) => info.country === COUNTRY_NAME);

    // ‚úÖ Render each tournament
    countryTournaments.forEach(([id, info]) => {
      const t = tournaments[id];
      const container = document.getElementById(info.section);

      if (!container) return; // safety check

      if (!t) {
        container.innerHTML = "<p>No results found.</p>";
        return;
      }

      const div = document.createElement("div");
      div.className = "tournament-card";

      if (t.status === "completed") {
        const results = t.top4 || t.top5 || [];

        const resultsTable = results
          .map(player => {
            const trophy = TROPHIES[player.rank] || "";
            return `
              <tr>
                <td>${trophy} ${player.rank}</td>
                <td>${player.name}</td>
              </tr>
            `;
          })
          .join("");

        div.innerHTML = `
          <table class="standings-table">
            <tr><th>Rank</th><th>Player</th></tr>
            ${resultsTable}
          </table>
          <p><a href="https://boardgamearena.com/tournament?id=${t.id}" target="_blank">View on BGA</a></p>
        `;
      } else if (t.status === "ongoing") {
        div.innerHTML = `
          <h3>Tournament ongoing</h3>
          <p><a href="https://boardgamearena.com/tournament?id=${t.id}" target="_blank">View on BGA</a></p>
        `;
      }

      container.appendChild(div);
    });
  }

  loadCountryTournaments();
</script>

</body>
</html>
