<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Norway ¬∑ Around the World in 80 Games</title>
  <link rel="stylesheet" href="../assets/css/style.css" />
</head>

<body>

  <header>
    <h1>Norway</h1>
    <div class="country-nav">
    <a href="sweden.html" class="prev">‚Üê Sweden</a>
    <a href="russia.html" class="next">Russia ‚Üí</a>
    </div>
  </header>

  <main>
    <section>
      <h2>Overview</h2>
      <div class="placeholder">
      <p>Next up, we explore Scandinavia more broadly through two very different card games, as we go back in time to the Viking Era of 800 AD to 1050 AD - an age when Vikings explored, settled and raided across Northern Europe and even as far as Greenland, Canada and the Mediterranean. Often depicted as brutal invaders, Vikings were skilled craftspeople, often preferring to trade, albeit with a strong drive to fight for supremacy among tribes. </p> 
      <p>First up is Herrlof, a trick-taking game where players compete to strengthen their tribe by secretly bidding how many tricks they will win and using special power cards to their best advantage. </p>
      <p>Knarr is a straight engine-building points race as players recruit Viking warriors, using their abilities to cumulate resources and explore locations in the first to the finish.</p>
      </div>
    </section>

<section>
  <h2>Herrlof results</h2>
  <div class="placeholder">
    <div id="herrlof-tournaments"></div>
  </div>
</section>

<section>
  <h2>Knarr results</h2>
  <div class="placeholder">
    <div id="knarr-tournaments"></div>
  </div>
</section>

  </main>

  <footer>
    <p>¬© 2025 Around the World in 80 Games</p>
  </footer>

  <!-- ‚úÖ Load global script FIRST so BASE + sidenav are ready -->
  <script src="../assets/js/script.js"></script>

  <!-- ‚úÖ Country-specific logic AFTER script.js -->
  <script>
  const COUNTRY_NAME = "Norway"; // ‚úÖ change per country

  const TROPHIES = {
    "1st": "ü•á",
    "2nd": "ü•à",
    "3rd": "ü•â"
  };

  async function loadCountryTournaments() {
    // ‚úÖ Load tournament data + metadata
    const tournaments = await fetch(`${BASE}/data/tournaments.json`).then(r => r.json());
    const meta = await fetch(`${BASE}/data/tournament-meta.json`).then(r => r.json());

    // ‚úÖ Filter metadata to only this country‚Äôs tournaments
    const countryTournaments = Object.entries(meta)
      .filter(([id, info]) => info.country === COUNTRY_NAME);

    // ‚úÖ Render each tournament
    countryTournaments.forEach(([id, info]) => {
      const t = tournaments[id];
      const container = document.getElementById(info.section);

      if (!container) return; // safety check

      if (!t) {
        container.innerHTML = "<p>No results found.</p>";
        return;
      }

      const div = document.createElement("div");
      div.className = "tournament-card";

      if (t.status === "completed") {
        const results = t.top4 || t.top5 || [];

        const resultsTable = results
          .map(player => {
            const trophy = TROPHIES[player.rank] || "";
            return `
              <tr>
                <td>${trophy} ${player.rank}</td>
                <td>${player.name}</td>
              </tr>
            `;
          })
          .join("");

        div.innerHTML = `
          <table class="standings-table">
            <tr><th>Rank</th><th>Player</th></tr>
            ${resultsTable}
          </table>
          <p><a href="https://boardgamearena.com/tournament?id=${t.id}" target="_blank">View on BGA</a></p>
        `;
      } else if (t.status === "ongoing") {
        div.innerHTML = `
          <h3>Tournament ${t.id} ‚Äî Ongoing</h3>
          <p>Round: ${t.round || "Unknown"}</p>
          <p><a href="https://boardgamearena.com/tournament?id=${t.id}" target="_blank">View on BGA</a></p>
        `;
      }

      container.appendChild(div);
    });
  }

  loadCountryTournaments();
</script>

</body>
</html>
