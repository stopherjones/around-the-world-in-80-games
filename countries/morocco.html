<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Morocco ¬∑ Around the World in 80 Games</title>
  <link rel="stylesheet" href="../assets/css/style.css" />
</head>

<body>

  <header>
    <h1>Morocco</h1>
    <div class="country-nav">
    <a href="portugal.html" class="prev">‚Üê Portugal</a>
    <a href="sahara.html" class="next">Sahara ‚Üí</a>
    </div>
  </header>

  <main>
    <section>
      <h2>Overview</h2>
      <div class="placeholder">
      <p>We leave Europe, travelling south across the Mediterranean and to Africa and Morocco - a land steeped in history where desert sands meet rugged mountains - from the windswept dunes of the Sahara to the snow-capped Atlas peaks, Morocco is a country of breathtaking contrasts.</p>
<p>At the heart of Morocco lies the marketplace, or souk, where carpets, spices, lanterns, and textiles overflow in dazzling displays. It is in this setting that our next game unfolds - in Marrakech, players step into the role of carpet traders, manoeuvering their wares across the bustling market floor while outwitting rivals in a contest of placement, negotiation, and luck.</p>
<p>Moroccan is equally renowned for its diverse architecture: Berber Kasbahs sit alongside Islamic minarets, Moorish white stucco facades and French Art Deco buildings. In Medina players compete to rebuild the historic quarter located at the foot of the Atlas mountains.</p>
      </div>
    </section>

    <section>
      <h2>Medina reults</h2>
      <div class="placeholder">
     <div id="medina-tournaments"></div>
</div>
    </section>

<section>
  <h2>Marrakech results</h2>
  <div class="placeholder">
    <div id="marrakech-tournaments"></div>
  </div>
</section>

  </main>

  <footer>
    <p>¬© 2025 Around the World in 80 Games</p>
  </footer>

  <!-- ‚úÖ Load global script FIRST so BASE + sidenav are ready -->
  <script src="../assets/js/script.js"></script>

  <!-- ‚úÖ Country-specific logic AFTER script.js -->
  <script>
  const COUNTRY_NAME = "Morocco"; // ‚úÖ change per country

  const TROPHIES = {
    "1st": "ü•á",
    "2nd": "ü•à",
    "3rd": "ü•â"
  };

  async function loadCountryTournaments() {
    // ‚úÖ Load from cached/preloaded data instead of fetching
    const { tournaments, meta } = await loadData();

    // ‚úÖ Filter metadata to only this country‚Äôs tournaments
    const countryTournaments = Object.entries(meta)
      .filter(([id, info]) => info.country === COUNTRY_NAME);

    // ‚úÖ Render each tournament
    countryTournaments.forEach(([id, info]) => {
      const t = tournaments[id];
      const container = document.getElementById(info.section);

      if (!container) return; // safety check

      if (!t) {
        container.innerHTML = "<p>No results found.</p>";
        return;
      }

      const div = document.createElement("div");
      div.className = "tournament-card";

      if (t.status === "completed") {
        const results = t.top4 || t.top5 || [];

        const resultsTable = results
          .map(player => {
            const trophy = TROPHIES[player.rank] || "";
            return `
              <tr>
                <td>${trophy} ${player.rank}</td>
                <td>${player.name}</td>
              </tr>
            `;
          })
          .join("");

        div.innerHTML = `
          <table class="standings-table">
            <tr><th>Rank</th><th>Player</th></tr>
            ${resultsTable}
          </table>
          <p><a href="https://boardgamearena.com/tournament?id=${t.id}" target="_blank">View on BGA</a></p>
        `;
      } else if (t.status === "ongoing") {
        div.innerHTML = `
          <h3>Tournament ongoing</h3>
          <p><a href="https://boardgamearena.com/tournament?id=${t.id}" target="_blank">View on BGA</a></p>
        `;
      }

      container.appendChild(div);
    });
  }

  loadCountryTournaments();
</script>

</body>
</html>
