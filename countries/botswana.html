<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Botswana ¬∑ Around the World in 80 Games</title>
  <link rel="stylesheet" href="../assets/css/style.css" />
</head>

<body>

  <header>
    <h1>Botswana</h1>
    <div class="country-nav">
    <a href="sahara.html" class="prev">‚Üê Sahara</a>
    <a href="southafrica.html" class="next">South Africa ‚Üí</a>
    </div>
  </header>

  <main>
    <section>
      <h2>Overview</h2>
      <div class="placeholder">
      <p>From the Sahara to the Kalahari next, and to Botswana, a rich and, fertile land famed for its vastness, its beauty and, of course, its wildlife.</p>
      <p>But Botswana is more than its wilderness. It is one of Africa‚Äôs most stable and forward-looking nations, rich in both natural resources and cultural heritage.</p>
      <p>Our next game takes us, quite literally, deep down to those resources, in the heart of the world‚Äôs largest diamond mine; Orapa Mine.</p>
      <p>Like a mashup between Reflection and Battleships, Orapa Mine is a game of deduction that sees players sending out ultrasonic waves in an attempt to be the first to discover the type and location of the gems hidden deep below the surface. </p>
      </div>
    </section>

    <section>
      <h2>Orapa Mine results</h2>
      <div class="placeholder">
     <div id="orapa-mine-tournaments"></div>
</div>
    </section>

  </main>

  <footer>
    <p>¬© 2025 Around the World in 80 Games</p>
  </footer>

  <!-- ‚úÖ Load global script FIRST so BASE + sidenav are ready -->
  <script src="../assets/js/script.js"></script>

  <!-- ‚úÖ Country-specific logic AFTER script.js -->
  <script>
  const COUNTRY_NAME = "Botswana"; // ‚úÖ change per country

  const TROPHIES = {
    "1st": "ü•á",
    "2nd": "ü•à",
    "3rd": "ü•â"
  };

  async function loadCountryTournaments() {
    // ‚úÖ Load from cached/preloaded data instead of fetching
    const { tournaments, meta } = await loadData();

    // ‚úÖ Filter metadata to only this country‚Äôs tournaments
    const countryTournaments = Object.entries(meta)
      .filter(([id, info]) => info.country === COUNTRY_NAME);

    // ‚úÖ Render each tournament
    countryTournaments.forEach(([id, info]) => {
      const t = tournaments[id];
      const container = document.getElementById(info.section);

      if (!container) return; // safety check

      if (!t) {
        container.innerHTML = "<p>No results found.</p>";
        return;
      }

      const div = document.createElement("div");
      div.className = "tournament-card";

      if (t.status === "completed") {
        const results = t.top4 || t.top5 || [];

        const resultsTable = results
          .map(player => {
            const trophy = TROPHIES[player.rank] || "";
            return `
              <tr>
                <td>${trophy} ${player.rank}</td>
                <td>${player.name}</td>
              </tr>
            `;
          })
          .join("");

        div.innerHTML = `
          <table class="standings-table">
            <tr><th>Rank</th><th>Player</th></tr>
            ${resultsTable}
          </table>
          <p><a href="https://boardgamearena.com/tournament?id=${t.id}" target="_blank">View on BGA</a></p>
        `;
      } else if (t.status === "ongoing") {
        div.innerHTML = `
          <h3>Tournament ongoing</h3>
          <p><a href="https://boardgamearena.com/tournament?id=${t.id}" target="_blank">View on BGA</a></p>
        `;
      }

      container.appendChild(div);
    });
  }

  loadCountryTournaments();
</script>

</body>
</html>
